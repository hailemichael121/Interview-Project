@baseUrl = https://tenanncy-backend.vercel.app/
@frontendUrl = https://tenanncy.vercel.app/
@contentType = application/json

###
# DYNAMIC VARIABLES (captured from test responses)
###

@authToken =v9WrePxssrSHIFXSuOMMvG4hPYRQs8CQ.Z1o7LCr41hpsIantC9YveKYK2qbFZNP0PofCBBWlcBA%3D
@userId = SaSO5KXwJhcIdS193zP8cvEUDJp7SkZ5
@organizationId = cmimwxehq0002lc6x8o2rjsw0
@outlineId = cmimwoqvq0002s06xrfu42da1
@inviteToken = bjmajlxltamim9pycw
@invitedEmail = yihunaashe@gmail.com
@memberUserId = cmima4wn400094x6666xwhz3g
@memberId = <capture-from-user-profile>

###
# 0. HEALTH CHECKS
###

GET {{baseUrl}}/

###
# 0.1 GET AUTH SESSION
###

GET {{baseUrl}}/api/auth/session
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 1. AUTH — SIGN UP (new user)
###
# @name signUp
POST {{baseUrl}}/api/auth/sign-up/email
Origin: {{frontendUrl}}
Content-Type: {{contentType}}

{
  "name": "Yihun Shekuri",
  "email": "yihunashe@gmail.com",
  "password": "password123"
}

###
# 1.1 AUTH — SIGN IN
###
# @name signIn
POST {{baseUrl}}/api/auth/sign-in/email
Origin: {{frontendUrl}}
Content-Type: {{contentType}}

{
  "email": "yihunashe@gmail.com",
  "password": "password123"
}

###
# 2. USER — GET CURRENT USER PROFILE (with memberships)
###

GET {{baseUrl}}/users/me
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 2.1 USER — GET DETAILED PROFILE
###

GET {{baseUrl}}/users/profile
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 2.2 USER — UPDATE PROFILE
###

PUT {{baseUrl}}/users/profile
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

{
  "name": "Yihun Shekuri Updated",
  "image": "https://example.com/avatar.jpg"
}

###
# 2.3 USER — GET USER BY ID
###

GET {{baseUrl}}/users/{{userId}}
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 2.4 USER — LIST ALL USERS
###

GET {{baseUrl}}/users
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 2.5 USER — SEARCH USERS
###

GET {{baseUrl}}/users/search/yihun
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 3. ORGANIZATION — CREATE
###
# @name createOrganization
POST {{baseUrl}}/api/organization/create
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

{
  "name": "Sharuk Khan PLC",
  "slug": "sharuk-khan-plc"
}

###
# 3.1 ORGANIZATION — LIST USER ORGANIZATIONS
###

GET {{baseUrl}}/api/organization
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 3.2 ORGANIZATION — GET DETAILS
###

GET {{baseUrl}}/api/organization/{{organizationId}}
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 3.3 ORGANIZATION — UPDATE
###

PUT {{baseUrl}}/api/organization/{{organizationId}}
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

{
  "name": "Sharuk Khan PLC Updated",
  "slug": "sharuk-khan-updated"
}

###
# 3.4 ORGANIZATION — SWITCH CONTEXT (must be member first)
###

POST {{baseUrl}}/api/organization/{{organizationId}}/switch
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

###
# 4. ORGANIZATION MEMBERS — LIST
###

GET {{baseUrl}}/api/organization/{{organizationId}}/members
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 4.1 ORGANIZATION — INVITE MEMBER
###
# @name inviteMember
POST {{baseUrl}}/api/organization/{{organizationId}}/invite
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

{
  "email": "testuser@example.com",
  "role": "MEMBER"
}

###
# 4.2 ORGANIZATION — ACCEPT INVITE
###
# @name acceptInvite
POST {{baseUrl}}/api/organization/accept-invite/{{inviteToken}}
Origin: {{frontendUrl}}
Content-Type: {{contentType}}

{
  "email": "yihunashe@gmail.com"
}

###
# 4.3 ORGANIZATION — REVOKE MEMBER
###

POST {{baseUrl}}/api/organization/{{organizationId}}/revoke
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

{
  "targetMemberId": "{{memberUserId}}"
}

###
# 5. USER INVITATIONS — GET PENDING INVITATIONS
###

GET {{baseUrl}}/users/invitations
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 5.1 USER — ACCEPT INVITATION
###

POST {{baseUrl}}/users/invitations/{{inviteToken}}/accept
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

{
  "email": "yihunashe@gmail.com"
}

###
# 5.2 USER — DECLINE INVITATION
###

POST {{baseUrl}}/users/invitations/{{inviteToken}}/decline
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

{
  "email": "yihunashe@gmail.com"
}

###
# 6. OUTLINES — CREATE
###
# @name createOutline
POST {{baseUrl}}/api/outlines
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

{
  "header": "Project Proposal Document",
  "sectionType": "TECHNICAL_APPROACH",
  "status": "IN_PROGRESS",
  "target": 5000,
  "limit": 6000,
  "reviewerId": null,
  "organizationId": "{{organizationId}}"
}

### Valid Section Types:
# TABLE_OF_CONTENTS, EXECUTIVE_SUMMARY, TECHNICAL_APPROACH, 
# DESIGN, CAPABILITIES, FOCUS_DOCUMENT, NARRATIVE

###
# 6.1 OUTLINES — LIST ALL (requires organization context)
###

GET {{baseUrl}}/api/outlines
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 6.2 OUTLINES — GET SINGLE
###

GET {{baseUrl}}/api/outlines/{{outlineId}}
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 6.3 OUTLINES — UPDATE
###

PUT {{baseUrl}}/api/outlines/{{outlineId}}
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

{
  "header": "Updated Project Proposal",
  "status": "COMPLETED",
  "target": 5500,
  "limit": 6500
}

###
# 6.4 OUTLINES — DELETE
###

DELETE {{baseUrl}}/api/outlines/{{outlineId}}
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 6.5 OUTLINES — GET ORGANIZATION STATS
###

GET {{baseUrl}}/api/outlines/organization/stats
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 6.6 OUTLINES — GET ASSIGNED AS REVIEWER
###

GET {{baseUrl}}/api/outlines/reviewer/assigned
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 6.7 OUTLINES — GET MY CREATED OUTLINES
###

GET {{baseUrl}}/api/outlines/creator/my-outlines
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 7. USER — GET USER ORGANIZATIONS (with pagination)
###

GET {{baseUrl}}/users/{{userId}}/organizations?page=1&perPage=10
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 8. USER — SOFT DELETE USER
###

DELETE {{baseUrl}}/users/{{userId}}
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}

###
# 9. TEST HEADERS FOR ORGANIZATION CONTEXT
###

# This requires X-Organization-Id header
POST {{baseUrl}}/api/outlines
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
X-Organization-Id: {{organizationId}}
Content-Type: {{contentType}}

{
  "header": "Test with Header Organization",
  "sectionType": "EXECUTIVE_SUMMARY",
  "target": 1000,
  "limit": 1200
}

###
# 10. TEST WITHOUT ORGANIZATION CONTEXT (should fail)
###

POST {{baseUrl}}/api/outlines
Origin: {{frontendUrl}}
Cookie: better-auth.session_token={{authToken}}
Content-Type: {{contentType}}

{
  "header": "Test without Organization",
  "sectionType": "EXECUTIVE_SUMMARY",
  "target": 1000,
  "limit": 1200
}